---
sidebar_position: 5
summary: Best practices for AI integration in Teams applications, including AI-generated message indicators, feedback collection for prompt improvement, and citation handling to ensure transparency and accuracy in AI responses.
---

# Best Practices

When sending messages using AI, Teams recommends a number of best practices to help with both user and developer experience.

## AI-Generated Indicator

When sending messages using AI, Teams recommends including an indicator that the message was generated by AI. This can be done by calling the `.AddAIGenerated()` method on outgoing messages. This will help users understand that the message was generated by AI, and not by a human and can help with trust and transparency.

```csharp
var messageActivity = new MessageActivity
{
    Text = "Hello!",
}.AddAIGenerated();
```

![AI Generated Indicator](/screenshots/ai-generated.gif)

## Gather feedback to improve prompts

AI Generated messages are not always perfect. Prompts can have gaps, and can sometimes lead to unexpected results. To help improve the prompts, Teams recommends gathering feedback from users on the AI-generated messages. See [Feedback](../feedback) for more information on how to gather feedback.

This does involve thinking through a pipeline for gathering feedback and then automatically, or manually, updating prompts based on the feedback. The feedback system is an point of entry to your eval pipeline.

## Citations

AI generated messages can hallucinate even if messages are grounded in real data. To help with this, Teams recommends including citations in the AI Generated messages. This is easy to do by using the `AddCitation` method on the message.

:::warning
Citations are added with a `position` property. This property value needs to also be included in the message text as `[<position>]`. If there is a citation that's added without the associated value in the message text, Teams will not render the citation
:::

```csharp
var messageActivity = new MessageActivity
{
    Text = result.Content,
}.AddAIGenerated();

for (int i = 0; i < citedDocs.Length; i++)
{
    messageActivity.Text += $"[{i + 1}]";
    messageActivity.AddCitation(i + 1, new CitationAppearance
    {
        Name = citedDocs[i].Title,
        Abstract = citedDocs[i].Content
    });
}
```

![AI Generated Indicator](/screenshots/citation.gif)
